<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Using Characterization Package â€¢ Characterization</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Using Characterization Package">
<meta property="og:description" content="Characterization">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Characterization</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/InstallationGuide.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/InstallationGuide.html">Characterization Installation Guide</a>
    </li>
    <li>
      <a href="../articles/Specification.html">Characterization Package Specification</a>
    </li>
    <li>
      <a href="../articles/UsingPackage.html">Using Characterization Package</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://ohdsi.github.io/Hades" class="external-link"><img src='https://ohdsi.github.io/Hades/images/hadesMini.png' width=80 height=17 style='vertical-align: top;'></a>
</li>
<li>
  <a href="https://github.com/OHDSI/PatientLevelPrediction" class="external-link">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Using Characterization Package</h1>
                        <h4 data-toc-skip class="author">Jenna Reps</h4>
            
            <h4 data-toc-skip class="date">2024-10-07</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/OHDSI/Characterization/blob/HEAD/vignettes/UsingPackage.Rmd" class="external-link"><code>vignettes/UsingPackage.Rmd</code></a></small>
      <div class="hidden name"><code>UsingPackage.Rmd</code></div>

    </div>

    
    
<!--
%\VignetteEngine{knitr}
%\VignetteIndexEntry{Using_Characterization_Package}
-->
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This vignette describes how you can use the Characterization package
for various descriptive studies using OMOP CDM data. The
Characterization package currently contains three different types of
analyses:</p>
<ul>
<li>Aggregate Covariates: this returns the mean feature value for a set
of features specified by the user for i) the Target cohort population,
ii) the Outcome cohort population, iii) the Target population patients
who had the outcome during some user specified time-at-risk and iv) the
Target population patients who did not have the outcome during some user
specified time-at-risk.</li>
<li>DechallengeRechallenge: this is mainly aimed at investigating
whether a drug and event are causally related by seeing whether the drug
is stopped close in time to the event occurrence (dechallenge) and then
whether the drug is restarted (a rechallenge occurs) and if so, whether
the event starts again (a failed rechallenge). In this analysis, the
Target cohorts are the drug users of interest and the Outcome cohorts
are the medical events you wish to see whether the drug may cause. The
user must also specify how close in time a drug must be stopped after
the outcome to be considered a dechallenge and how close in time an
Outcome must occur after restarting the drug to be considered a failed
rechallenge).</li>
<li>Time-to-event: this returns descriptive results showing the timing
between the target cohort and outcome. This can help identify whether
the outcome often precedes the target cohort or whether it generally
comes after.</li>
</ul>
</div>
<div class="section level2">
<h2 id="setup">Setup<a class="anchor" aria-label="anchor" href="#setup"></a>
</h2>
<p>In this vignette we will show working examples using the
<code>Eunomia</code> R package that contains simulated data. Run the
following code to install the <code>Eunomia</code> R package:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"remotes"</span><span class="op">)</span></span>
<span><span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"ohdsi/Eunomia"</span><span class="op">)</span></span></code></pre></div>
<p>Eunomia can be used to create a temporary SQLITE database with the
simulated data. The function <code>getEunomiaConnectionDetails</code>
creates a SQLITE connection to a temporary location. The function
<code>createCohorts</code> then populates the temporary SQLITE database
with the simulated data ready to be used.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">connectionDetails</span> <span class="op">&lt;-</span> <span class="fu">Eunomia</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Eunomia/man/getEunomiaConnectionDetails.html" class="external-link">getEunomiaConnectionDetails</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu">Eunomia</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Eunomia/man/createCohorts.html" class="external-link">createCohorts</a></span><span class="op">(</span>connectionDetails <span class="op">=</span> <span class="va">connectionDetails</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Connecting using SQLite driver</span></span></code></pre>
<pre><code>## Creating cohort: Celecoxib
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%</code></pre>
<pre><code><span><span class="co">## Executing SQL took 0.0129 secs</span></span></code></pre>
<pre><code>## Creating cohort: Diclofenac
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%</code></pre>
<pre><code><span><span class="co">## Executing SQL took 0.00521 secs</span></span></code></pre>
<pre><code>## Creating cohort: GiBleed
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%</code></pre>
<pre><code><span><span class="co">## Executing SQL took 0.00938 secs</span></span></code></pre>
<pre><code>## Creating cohort: NSAIDs
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%</code></pre>
<pre><code><span><span class="co">## Executing SQL took 0.05 secs</span></span></code></pre>
<pre><code><span><span class="co">## Cohorts created in table main.cohort</span></span></code></pre>
<pre><code><span><span class="co">##   cohortId       name</span></span>
<span><span class="co">## 1        1  Celecoxib</span></span>
<span><span class="co">## 2        2 Diclofenac</span></span>
<span><span class="co">## 3        3    GiBleed</span></span>
<span><span class="co">## 4        4     NSAIDs</span></span>
<span><span class="co">##                                                                                        description</span></span>
<span><span class="co">## 1    A simplified cohort definition for new users of celecoxib, designed specifically for Eunomia.</span></span>
<span><span class="co">## 2    A simplified cohort definition for new users ofdiclofenac, designed specifically for Eunomia.</span></span>
<span><span class="co">## 3 A simplified cohort definition for gastrointestinal bleeding, designed specifically for Eunomia.</span></span>
<span><span class="co">## 4       A simplified cohort definition for new users of NSAIDs, designed specifically for Eunomia.</span></span>
<span><span class="co">##   count</span></span>
<span><span class="co">## 1  1844</span></span>
<span><span class="co">## 2   850</span></span>
<span><span class="co">## 3   479</span></span>
<span><span class="co">## 4  2694</span></span></code></pre>
<p>We also need to have the Characterization package installed and
loaded</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"ohdsi/FeatureExtraction"</span><span class="op">)</span></span>
<span><span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"ohdsi/Characterization"</span>, ref <span class="op">=</span> <span class="st">"new_approach"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ohdsi.github.io/Characterization" class="external-link">Characterization</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Attaching package: 'dplyr'</span></span></code></pre>
<pre><code><span><span class="co">## The following objects are masked from 'package:stats':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     filter, lag</span></span></code></pre>
<pre><code><span><span class="co">## The following objects are masked from 'package:base':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     intersect, setdiff, setequal, union</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="examples">Examples<a class="anchor" aria-label="anchor" href="#examples"></a>
</h2>
<div class="section level3">
<h3 id="aggreagate-covariates">Aggreagate Covariates<a class="anchor" aria-label="anchor" href="#aggreagate-covariates"></a>
</h3>
<p>To run an â€˜Aggregate Covariateâ€™ analysis you need to create a setting
object using <code>createAggregateCovariateSettings</code>. This
requires specifying:</p>
<ul>
<li>one or more targetIds (these must be pre-generated in a cohort
table)</li>
<li>one or more outcomeIds (these must be pre-generated in a cohort
table)</li>
<li>the covariate settings using
<code><a href="https://rdrr.io/pkg/FeatureExtraction/man/createCovariateSettings.html" class="external-link">FeatureExtraction::createCovariateSettings</a></code> or by creating
your own custom feature extraction code.</li>
<li>the time-at-risk settings</li>
<li>riskWindowStart</li>
<li>startAnchor</li>
<li>riskWindowEnd</li>
<li>endAnchor</li>
</ul>
<p>Using the Eunomia data were we previous generated four cohorts, we
can use cohort ids 1,2 and 4 as the targetIds and cohort id 3 as the
outcomeIds:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">exampleTargetIds</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">exampleOutcomeIds</span> <span class="op">&lt;-</span> <span class="fl">3</span></span></code></pre></div>
<p>If we want to get information on the sex, age at index and Charlson
Comorbidity index we can create the settings using
<code><a href="https://rdrr.io/pkg/FeatureExtraction/man/createCovariateSettings.html" class="external-link">FeatureExtraction::createCovariateSettings</a></code>:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">exampleCovariateSettings</span> <span class="op">&lt;-</span> <span class="fu">FeatureExtraction</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/FeatureExtraction/man/createCovariateSettings.html" class="external-link">createCovariateSettings</a></span><span class="op">(</span></span>
<span>  useDemographicsGender <span class="op">=</span> <span class="cn">T</span>,</span>
<span>  useDemographicsAge <span class="op">=</span> <span class="cn">T</span>,</span>
<span>  useCharlsonIndex <span class="op">=</span> <span class="cn">T</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>There is an additional covariate setting require that is calculated
for the cases (patients in the target cohort with have the outcome
during the time-at-risk). This is called caseCovariateSettings and
should be created using the createDuringCovariateSettings function. The
user can pick conditions, drugs, measurements, procedures and
observations. In this example, we just include condition eras groups by
vocabulary heirarchy. We also need to specify two related variables
<code>casePreTargetDuration</code> which is the number of days before
target index to extract features for the cases (answers what happens
shortly before the target index) and
<code>casePostOutcomeDuration</code> which is the number of days after
the outcome date to extract features for the cases (answers what happens
after the outcome). The case covariates are also extracted between
target index and outcome (answers the question what happens during
target exposure).</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">caseCovariateSettings</span> <span class="op">&lt;-</span> <span class="fu">Characterization</span><span class="fu">::</span><span class="fu"><a href="../reference/createDuringCovariateSettings.html">createDuringCovariateSettings</a></span><span class="op">(</span></span>
<span>  useConditionGroupEraDuring <span class="op">=</span> <span class="cn">T</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>If we want to create the aggregate features for all our target
cohorts, our outcome cohort and each target cohort restricted to those
with a record of the outcome 1 day after target cohort start date until
365 days after target cohort end date with a outcome washout of 9999
(meaning we only include outcomes that are the first occurrence in the
past 9999 days) and only include targets or outcomes where the patient
was observed for 365 days or more prior, we can run:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">exampleAggregateCovariateSettings</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createAggregateCovariateSettings.html">createAggregateCovariateSettings</a></span><span class="op">(</span></span>
<span>  targetIds <span class="op">=</span> <span class="va">exampleTargetIds</span>,</span>
<span>  outcomeIds <span class="op">=</span> <span class="va">exampleOutcomeIds</span>,</span>
<span>  riskWindowStart <span class="op">=</span> <span class="fl">1</span>, startAnchor <span class="op">=</span> <span class="st">"cohort start"</span>,</span>
<span>  riskWindowEnd <span class="op">=</span> <span class="fl">365</span>, endAnchor <span class="op">=</span> <span class="st">"cohort start"</span>,</span>
<span>  outcomeWashoutDays <span class="op">=</span> <span class="fl">9999</span>,</span>
<span>  minPriorObservation <span class="op">=</span> <span class="fl">365</span>,</span>
<span>  covariateSettings <span class="op">=</span> <span class="va">exampleCovariateSettings</span>,</span>
<span>  caseCovariateSettings <span class="op">=</span> <span class="va">caseCovariateSettings</span>,</span>
<span>  casePreTargetDuration <span class="op">=</span> <span class="fl">90</span>,</span>
<span>  casePostOutcomeDuration <span class="op">=</span> <span class="fl">90</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Next we need to use the
<code>exampleAggregateCovariateSettings</code> as the settings to
<code>computeAggregateCovariateAnalyses</code>, we need to use the
Eunomia connectionDetails and in Eunomia the OMOP CDM data and cohort
table are in the â€˜mainâ€™ schema. The cohort table name is â€˜cohortâ€™. The
following code will apply the aggregated covariates analysis using the
previously specified settings on the simulated Eunomia data, but we can
specify the <code>minCharacterizationMean</code> to exclude covarites
with mean values below 0.01, and we must specify the
<code>outputFolder</code> where the csv results will be written to.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/runCharacterizationAnalyses.html">runCharacterizationAnalyses</a></span><span class="op">(</span></span>
<span>  connectionDetails <span class="op">=</span> <span class="va">connectionDetails</span>,</span>
<span>  cdmDatabaseSchema <span class="op">=</span> <span class="st">"main"</span>,</span>
<span>  targetDatabaseSchema <span class="op">=</span> <span class="st">"main"</span>,</span>
<span>  targetTable <span class="op">=</span> <span class="st">"cohort"</span>,</span>
<span>  outcomeDatabaseSchema <span class="op">=</span> <span class="st">"main"</span>,</span>
<span>  outcomeTable <span class="op">=</span> <span class="st">"cohort"</span>,</span>
<span>  characterizationSettings <span class="op">=</span> <span class="fu"><a href="../reference/createCharacterizationSettings.html">createCharacterizationSettings</a></span><span class="op">(</span></span>
<span>    aggregateCovariateSettings <span class="op">=</span> <span class="va">exampleAggregateCovariateSettings</span></span>
<span>  <span class="op">)</span>,</span>
<span>  databaseId <span class="op">=</span> <span class="st">"Eunomia"</span>,</span>
<span>  runId <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  minCharacterizationMean <span class="op">=</span> <span class="fl">0.01</span>,</span>
<span>  outputDirectory <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html" class="external-link">getwd</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"example_char"</span>, <span class="st">"results"</span><span class="op">)</span>, executionPath <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html" class="external-link">getwd</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"example_char"</span>, <span class="st">"execution"</span><span class="op">)</span>,</span>
<span>  minCellCount <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  incremental <span class="op">=</span> <span class="cn">F</span>,</span>
<span>  threads <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>You can then see the results in the location
<code>file.path(getwd(), 'example_char', 'results')</code> where you
will find csv files.</p>
</div>
<div class="section level3">
<h3 id="dechallenge-rechallenge">Dechallenge Rechallenge<a class="anchor" aria-label="anchor" href="#dechallenge-rechallenge"></a>
</h3>
<p>To run a â€˜Dechallenge Rechallengeâ€™ analysis you need to create a
setting object using <code>createDechallengeRechallengeSettings</code>.
This requires specifying:</p>
<ul>
<li>one or more targetIds (these must be pre-generated in a cohort
table)</li>
<li>one or more outcomeIds (these must be pre-generated in a cohort
table)</li>
<li>dechallengeStopInterval</li>
<li>dechallengeEvaluationWindow</li>
</ul>
<p>Using the Eunomia data were we previous generated four cohorts, we
can use cohort ids 1,2 and 4 as the targetIds and cohort id 3 as the
outcomeIds:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">exampleTargetIds</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">exampleOutcomeIds</span> <span class="op">&lt;-</span> <span class="fl">3</span></span></code></pre></div>
<p>If we want to create the dechallenge rechallenge for all our target
cohorts and our outcome cohort with a 30 day dechallengeStopInterval and
31 day dechallengeEvaluationWindow:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">exampleDechallengeRechallengeSettings</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createDechallengeRechallengeSettings.html">createDechallengeRechallengeSettings</a></span><span class="op">(</span></span>
<span>  targetIds <span class="op">=</span> <span class="va">exampleTargetIds</span>,</span>
<span>  outcomeIds <span class="op">=</span> <span class="va">exampleOutcomeIds</span>,</span>
<span>  dechallengeStopInterval <span class="op">=</span> <span class="fl">30</span>,</span>
<span>  dechallengeEvaluationWindow <span class="op">=</span> <span class="fl">31</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>We can then run the analysis on the Eunomia data using
<code>computeDechallengeRechallengeAnalyses</code> and the settings
previously specified, with <code>minCellCount</code> removing values
less than the specified value:</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/computeDechallengeRechallengeAnalyses.html">computeDechallengeRechallengeAnalyses</a></span><span class="op">(</span></span>
<span>  connectionDetails <span class="op">=</span> <span class="va">connectionDetails</span>,</span>
<span>  targetDatabaseSchema <span class="op">=</span> <span class="st">"main"</span>,</span>
<span>  targetTable <span class="op">=</span> <span class="st">"cohort"</span>,</span>
<span>  settings <span class="op">=</span> <span class="va">exampleDechallengeRechallengeSettings</span>,</span>
<span>  databaseId <span class="op">=</span> <span class="st">"Eunomia"</span>,</span>
<span>  outcomeTable <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html" class="external-link">getwd</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"example_char"</span>, <span class="st">"results"</span><span class="op">)</span>,</span>
<span>  minCellCount <span class="op">=</span> <span class="fl">5</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Next it is possible to compute the failed rechallenge cases</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">failed</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/computeRechallengeFailCaseSeriesAnalyses.html">computeRechallengeFailCaseSeriesAnalyses</a></span><span class="op">(</span></span>
<span>  connectionDetails <span class="op">=</span> <span class="va">connectionDetails</span>,</span>
<span>  targetDatabaseSchema <span class="op">=</span> <span class="st">"main"</span>,</span>
<span>  targetTable <span class="op">=</span> <span class="st">"cohort"</span>,</span>
<span>  settings <span class="op">=</span> <span class="va">exampleDechallengeRechallengeSettings</span>,</span>
<span>  outcomeDatabaseSchema <span class="op">=</span> <span class="st">"main"</span>,</span>
<span>  outcomeTable <span class="op">=</span> <span class="st">"cohort"</span>,</span>
<span>  databaseId <span class="op">=</span> <span class="st">"Eunomia"</span>,</span>
<span>  outcomeTable <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html" class="external-link">getwd</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"example_char"</span>, <span class="st">"results"</span><span class="op">)</span>,</span>
<span>  minCellCount <span class="op">=</span> <span class="fl">5</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="time-to-event">Time to Event<a class="anchor" aria-label="anchor" href="#time-to-event"></a>
</h3>
<p>To run a â€˜Time-to-eventâ€™ analysis you need to create a setting object
using <code>createTimeToEventSettings</code>. This requires
specifying:</p>
<ul>
<li>one or more targetIds (these must be pre-generated in a cohort
table)</li>
<li>one or more outcomeIds (these must be pre-generated in a cohort
table)</li>
</ul>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">exampleTimeToEventSettings</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createTimeToEventSettings.html">createTimeToEventSettings</a></span><span class="op">(</span></span>
<span>  targetIds <span class="op">=</span> <span class="va">exampleTargetIds</span>,</span>
<span>  outcomeIds <span class="op">=</span> <span class="va">exampleOutcomeIds</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>We can then run the analysis on the Eunomia data using
<code>computeTimeToEventAnalyses</code> and the settings previously
specified:</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tte</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/computeTimeToEventAnalyses.html">computeTimeToEventAnalyses</a></span><span class="op">(</span></span>
<span>  connectionDetails <span class="op">=</span> <span class="va">connectionDetails</span>,</span>
<span>  cdmDatabaseSchema <span class="op">=</span> <span class="st">"main"</span>,</span>
<span>  targetDatabaseSchema <span class="op">=</span> <span class="st">"main"</span>,</span>
<span>  targetTable <span class="op">=</span> <span class="st">"cohort"</span>,</span>
<span>  settings <span class="op">=</span> <span class="va">exampleTimeToEventSettings</span>,</span>
<span>  databaseId <span class="op">=</span> <span class="st">"Eunomia"</span>,</span>
<span>  outcomeTable <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html" class="external-link">getwd</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"example_char"</span>, <span class="st">"results"</span><span class="op">)</span>,</span>
<span>  minCellCount <span class="op">=</span> <span class="fl">5</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="run-multiple">Run Multiple<a class="anchor" aria-label="anchor" href="#run-multiple"></a>
</h3>
<p>If you want to run multiple analyses (of the three previously shown)
you can use <code>createCharacterizationSettings</code>. You need to
input a list of each of the settings (or NULL if you do not want to run
one type of analysis). To run all the analyses previously shown in one
function:</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">characterizationSettings</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createCharacterizationSettings.html">createCharacterizationSettings</a></span><span class="op">(</span></span>
<span>  timeToEventSettings <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="va">exampleTimeToEventSettings</span></span>
<span>  <span class="op">)</span>,</span>
<span>  dechallengeRechallengeSettings <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="va">exampleDechallengeRechallengeSettings</span></span>
<span>  <span class="op">)</span>,</span>
<span>  aggregateCovariateSettings <span class="op">=</span> <span class="va">exampleAggregateCovariateSettings</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># save the settings using</span></span>
<span><span class="fu"><a href="../reference/saveCharacterizationSettings.html">saveCharacterizationSettings</a></span><span class="op">(</span></span>
<span>  settings <span class="op">=</span> <span class="va">characterizationSettings</span>,</span>
<span>  saveDirectory <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"saveSettings"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># the settings can be loaded</span></span>
<span><span class="va">characterizationSettings</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/loadCharacterizationSettings.html">loadCharacterizationSettings</a></span><span class="op">(</span></span>
<span>  saveDirectory <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"saveSettings"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/runCharacterizationAnalyses.html">runCharacterizationAnalyses</a></span><span class="op">(</span></span>
<span>  connectionDetails <span class="op">=</span> <span class="va">connectionDetails</span>,</span>
<span>  cdmDatabaseSchema <span class="op">=</span> <span class="st">"main"</span>,</span>
<span>  targetDatabaseSchema <span class="op">=</span> <span class="st">"main"</span>,</span>
<span>  targetTable <span class="op">=</span> <span class="st">"cohort"</span>,</span>
<span>  outcomeDatabaseSchema <span class="op">=</span> <span class="st">"main"</span>,</span>
<span>  outcomeTable <span class="op">=</span> <span class="st">"cohort"</span>,</span>
<span>  characterizationSettings <span class="op">=</span> <span class="va">characterizationSettings</span>,</span>
<span>  outputDirectory <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"example"</span>, <span class="st">"results"</span><span class="op">)</span>,</span>
<span>  executionPath <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"example"</span>, <span class="st">"execution"</span><span class="op">)</span>,</span>
<span>  csvFilePrefix <span class="op">=</span> <span class="st">"c_"</span>,</span>
<span>  databaseId <span class="op">=</span> <span class="st">"1"</span>,</span>
<span>  incremental <span class="op">=</span> <span class="cn">F</span>,</span>
<span>  minCharacterizationMean <span class="op">=</span> <span class="fl">0.01</span>,</span>
<span>  minCellCount <span class="op">=</span> <span class="fl">5</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>This will create csv files with the results in the saveDirectory. You
can run the following code to view the results in a shiny app:</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/viewCharacterization.html">viewCharacterization</a></span><span class="op">(</span></span>
<span>  resultFolder <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"example"</span>, <span class="st">"results"</span><span class="op">)</span>,</span>
<span>  cohortDefinitionSet <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Jenna Reps, Patrick Ryan, Chris Knoll.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
